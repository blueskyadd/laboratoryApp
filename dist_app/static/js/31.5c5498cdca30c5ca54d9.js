webpackJsonp([31],{"80dg":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("HY5T"),n=a("aerq"),o=a("UNGY"),s=a("rHil"),l=a("2sLL"),u=a("7Ah8"),p=(o.a,s.a,l.a,i.a,u.a,{name:"ApplyWatch",components:{Datetime:o.a,Group:s.a,XButton:l.a,setpopupPicker:i.a,PopupPicker:u.a},data:function(){return{startTime:"",startEnd:"",popupMaterialObj:{placeholderTitle:"请选择",popupTitle:"值班地点",popupList:[],activelyData:[]},format:function(t,e){return t[0]+":"+t[1]+":"+t[2]},equipmentDetail:{start_time:"",formatDemoValue:[],end_time:"",formatDemoValueEnd:[],location:"",cause:""}}},computed:{dataTime:function(){for(var t=[[],[],[]],e=0;e<60;e++)1==e.toString().length&&(e="0"+e),t[2].push(e),t[1].push(e),e<24&&t[0].push(e);return console.log(t),t}},mounted:function(){var t=this;this.$emit("setHeaderShow",{blod:!0,title:"值班申请"}),this.getTestengineer_roomList(),this.$nextTick(function(){t.$store.state.watch.equipmentDetail&&(t.equipmentDetail=t.$store.state.watch.equipmentDetail,t.equipmentDetail.cause=t.$store.state.synopsis.ApplyWatchText)})},beforeRouteLeave:function(t,e,a){console.log(t.name),"WatchManage"==t.name&&(this.$store.commit("changewatchDetail",{}),this.$store.commit("changeSynopsisText",{name:"",flag:"4"})),a()},methods:{goSynopsis:function(){this.$router.push({name:"Synopsis",params:{flag:"4"}}),this.$store.commit("changewatchDetail",this.equipmentDetail)},changeMaterial:function(t){this.equipmentDetail.location=1*t[0]},getTestengineer_roomList:function(){var t=this;this.$vux.loading.show(),this.$http.get(this.$conf.env.getTestengineer_roomList).then(function(e){e.data&&(e.data.forEach(function(t){t.value=t.id.toString()}),t.popupMaterialObj.popupList=e.data,t.$nextTick(function(){t.$store.state.watch.equipmentDetail.location&&(t.popupMaterialObj.activelyData[0]=t.$store.state.watch.equipmentDetail.location.toString())})),t.$vux.loading.hide()}).catch(function(e){t.$vux.loading.hide(),t.isMoremaintainrecord=!1,t.$vux.toast.text(e.response?e.response.data:"服务器错误","top")})},createdTestengineer_onduty:function(){var t=this;n.a.VerificationData(this.equipmentDetail,this)&&(this.equipmentDetail.start_time+="T"+this.equipmentDetail.formatDemoValue.join(":"),this.equipmentDetail.end_time+="T"+this.equipmentDetail.formatDemoValueEnd.join(":"),delete this.equipmentDetail.formatDemoValue,delete this.equipmentDetail.formatDemoValueEnd,this.$vux.loading.show(),this.$http.post(this.$conf.env.createdTestengineer_onduty,this.equipmentDetail).then(function(e){"201"==e.status?(t.$vux.toast.text("提交成功"),setTimeout(function(){t.$router.back()},100)):t.$vux.toast.text("提交失败"),t.$vux.loading.hide()}).catch(function(e){t.$vux.loading.hide(),t.$vux.toast.text(e.response?e.response.data:"服务器错误","top")}))}}}),r={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ApplyWatch body_main"},[a("div",{staticClass:"from"},[a("ul",{staticClass:"equipmentInfo margin_bottom"},[a("li",{staticClass:"vux-1px-b"},[a("i",{staticClass:"importantData"},[t._v("*")]),t._v(" "),a("datetime",{attrs:{format:"YYYY-MM-DD",placeholder:"请选择值班开始时间",title:"值班开始时间"},model:{value:t.equipmentDetail.start_time,callback:function(e){t.$set(t.equipmentDetail,"start_time",e)},expression:"equipmentDetail.start_time"}}),t._v(" "),a("div",{staticClass:"weui-cell__ft"})],1),t._v(" "),a("li",{staticClass:"vux-1px-b"},[a("i",{staticClass:"importantData"},[t._v("*")]),t._v(" "),a("popup-picker",{attrs:{title:"开始时间(时分秒)",data:t.dataTime,"display-format":t.format},model:{value:t.equipmentDetail.formatDemoValue,callback:function(e){t.$set(t.equipmentDetail,"formatDemoValue",e)},expression:"equipmentDetail.formatDemoValue"}})],1),t._v(" "),a("li",{staticClass:"vux-1px-b"},[a("i",{staticClass:"importantData"},[t._v("*")]),t._v(" "),a("datetime",{attrs:{format:"YYYY-MM-DD",placeholder:"请选择值班结束时间",title:"值班结束时间"},model:{value:t.equipmentDetail.end_time,callback:function(e){t.$set(t.equipmentDetail,"end_time",e)},expression:"equipmentDetail.end_time"}}),t._v(" "),a("div",{staticClass:"weui-cell__ft"})],1),t._v(" "),a("li",[a("i",{staticClass:"importantData"},[t._v("*")]),t._v(" "),a("popup-picker",{attrs:{title:"结束时间(时分秒)",data:t.dataTime,"display-format":t.format},model:{value:t.equipmentDetail.formatDemoValueEnd,callback:function(e){t.$set(t.equipmentDetail,"formatDemoValueEnd",e)},expression:"equipmentDetail.formatDemoValueEnd"}})],1)]),t._v(" "),a("ul",{staticClass:"equipmentFrom equipmentInfo margin_bottom"},[a("li",{staticClass:"changeList"},[a("i",{staticClass:"importantData"},[t._v("*")]),t._v(" "),a("setpopup-picker",{attrs:{placeholderTitle:t.popupMaterialObj.placeholderTitle,popupTitle:t.popupMaterialObj.popupTitle,popupList:t.popupMaterialObj.popupList,activelyData:t.popupMaterialObj.activelyData},on:{changeData:t.changeMaterial}})],1),t._v(" "),a("li",{on:{click:function(e){return t.goSynopsis()}}},[t._m(0),t._v(" "),a("span",{staticClass:"right_weui"},[a("p",[t._v(t._s(t.equipmentDetail.cause||"请编辑"))]),a("div",{staticClass:"weui-cell__ft"})])])])]),t._v(" "),a("x-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.createdTestengineer_onduty()}}},[t._v("申请")])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("span",[e("i",{staticClass:"importantData"},[this._v("*")]),this._v("申请原因")])}]};var c=a("VU/8")(p,r,!1,function(t){a("Dtom")},null,null);e.default=c.exports},Dtom:function(t,e){},aerq:function(t,e,a){"use strict";a("3BeM");e.a={VerificationData:function(t,e){for(var a in t)if("boolean"!=typeof t[a]&&!t[a])return e.$vux.toast.text("*为必填项哦","top"),!1;return!0}}}});
//# sourceMappingURL=31.5c5498cdca30c5ca54d9.js.map