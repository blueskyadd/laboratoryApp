webpackJsonp([72],{"32By":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s("2sLL"),n=s("HqzV"),a=(i.a,n.a,{name:"MalfunctionCause",components:{XButton:i.a,Search:n.a},data:function(){return{startTime:"",startEnd:"",results:[],value:"",equipmentDetail:{name:"设备名称",num:"",device_keeper:"负责人",room:"实验室"},isHidebutton:!0,innerHeight:window.innerHeight,heightChange:window.innerHeight,isMoremaintainrecord:!0,MoremaintainrecordNumber:1,page_size:15,searchText:""}},watch:{innerHeight:function(e,t){this.heightChange!=e?this.isHidebutton=!1:this.isHidebutton=!0}},mounted:function(){var e=this;this.$emit("setHeaderShow",{blod:!0,title:"新增报警"});window.onresize=function(){e.innerHeight=window.innerHeight},this.$store.state.alarm.equipmentDetail.id&&(this.equipmentDetail=this.$store.state.alarm.equipmentDetail),document.getElementsByClassName("vux-search_show")[0].addEventListener("scroll",function(t){t.target.scrollHeight-t.target.offsetHeight<t.target.scrollTop+20&&e.isMoremaintainrecord&&(e.isMoremaintainrecord=!1,e.MoremaintainrecordNumber+=1,e.searchTestengineer_searcheqList())});var t=document.getElementsByClassName("weui-cells")[0],s=document.getElementById("searchTop").offsetHeight,i=document.getElementsByClassName("vux-header-title")[0].offsetHeight;t.style.top=s+i+this.$StatusbarHeight+1+"px"},methods:{resultClick:function(e){this.equipmentDetail=e},getResult:function(e){this.MoremaintainrecordNumber=1,this.searchText=e,this.searchTestengineer_searcheqList()},searchTestengineer_searcheqList:function(){var e=this;this.$vux.loading.show(),this.$http.get(1==this.MoremaintainrecordNumber?this.$conf.env.searchTestengineer_searcheqList+this.searchText+"&page_size="+this.page_size:this.$conf.env.searchTestengineer_searcheqList+this.searchText+"&page_size="+this.page_size+"&p="+this.MoremaintainrecordNumber).then(function(t){e.isMoremaintainrecord=!!t.data.next,t.data.results&&(t.data.results.forEach(function(e){e.title=e.name,e.value=e.id}),e.results=1==e.MoremaintainrecordNumber?t.data.results:e.results.concat(t.data.results)),e.$vux.loading.hide()}).catch(function(t){e.$vux.loading.hide(),e.isMoremaintainrecord=!1,e.$vux.toast.text(t.response?t.response.data:"服务器错误","top")})},goMeasureFlow:function(){this.$router.push({name:"measureFlow"})},changeMaterial:function(e){console.log(e,1)},changeMaterialPoduct:function(e){console.log(e)},goSynopsis:function(){this.$router.push({name:"Synopsis",params:{flag:"3"}}),this.$store.commit("changeDetail",this.equipmentDetail)},createdTestengineer_alarm:function(){var e=this;console.log(this.$store.state.synopsis.MalfunctionCause),this.equipmentDetail.id?this.$store.state.synopsis.MalfunctionCause?(this.$vux.loading.show(),this.$http.post(this.$conf.env.createdTestengineer_alarm,{equipment:this.equipmentDetail.id,cause:this.$store.state.synopsis.MalfunctionCause}).then(function(t){"201"==t.status?(e.$vux.toast.text("提交成功"),setTimeout(function(){e.$router.back()},100)):e.$vux.toast.text("提交失败"),e.$vux.loading.hide()}).catch(function(t){e.$vux.loading.hide(),e.$vux.toast.text(t.response?t.response.data:"服务器错误","top")})):this.$vux.toast.text("请先输入报警原因"):this.$vux.toast.text("请先选择设备")}},beforeRouteLeave:function(e,t,s){console.log(e),"Malfunction"==e.name&&(this.$store.commit("changeDetail",{}),this.$store.commit("changeSynopsisText",{name:"",flag:"3"})),s()}}),o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"MalfunctionCause body_main"},[s("div",{staticClass:"from"},[s("ul",{staticClass:"equipmentInfo margin_bottom"},[s("li",{staticClass:"vux-1px-b",staticStyle:{"padding-right":"0"},attrs:{id:"searchTop"}},[s("span",[e._v("设备编号")]),e._v(" "),s("search",{ref:"search",attrs:{placeholder:"请输入设备编号",results:e.results,position:"absolute","auto-scroll-to-top":"",top:"66"},on:{"result-click":e.resultClick,"on-change":e.getResult},model:{value:e.equipmentDetail.num,callback:function(t){e.$set(e.equipmentDetail,"num",t)},expression:"equipmentDetail.num"}})],1),e._v(" "),s("li",[s("span",[e._v("设备名称")]),e._v(" "),s("span",[e._v(e._s(e.equipmentDetail.name))])])]),e._v(" "),s("ul",{staticClass:" equipmentInfo margin_bottom"},[s("li",{staticClass:"changeList vux-1px-b"},[s("span",[e._v("实验室")]),e._v(" "),s("span",[e._v(e._s(e.equipmentDetail.room))])]),e._v(" "),s("li",{staticClass:"changeList"},[s("span",[e._v("负责人")]),e._v(" "),s("span",[e._v(e._s(e.equipmentDetail.device_keeper))])])]),e._v(" "),s("ul",{staticClass:"equipmentInfo "},[s("li",{on:{click:function(t){return e.goSynopsis()}}},[s("span",[e._v("报警原因")]),e._v(" "),s("span",{staticClass:"MalfunctionCauseText"},[s("p",[e._v(e._s(e.$store.state.synopsis.MalfunctionCause||"请编辑"))]),s("div",{staticClass:"weui-cell__ft"})])])])]),e._v(" "),s("x-button",{directives:[{name:"show",rawName:"v-show",value:e.isHidebutton,expression:"isHidebutton"}],attrs:{type:"primary"},nativeOn:{click:function(t){return e.createdTestengineer_alarm()}}},[e._v("申请")])],1)},staticRenderFns:[]};var r=s("VU/8")(a,o,!1,function(e){s("dOqm")},null,null);t.default=r.exports},dOqm:function(e,t){}});
//# sourceMappingURL=72.6b3463284453dade40de.js.map